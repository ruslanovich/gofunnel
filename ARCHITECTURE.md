# ARCHITECTURE.md

## Назначение

Этот документ фиксирует архитектурную рамку проекта до появления значимой кодовой базы, чтобы дальнейшие решения можно было проверять механически.

## Предполагаемые слои

Базовая схема (может быть адаптирована ADR-решением под выбранный стек):

1. `app/` — orchestration, use-cases, application services
2. `domain/` — бизнес-правила и модели предметной области
3. `infra/` — внешние интеграции, БД, очереди, API clients
4. `interfaces/` (или `adapters/`) — transport/UI/API handlers

## Правило зависимостей

- Зависимости направлены в одну сторону: outer layers зависят от inner layers.
- `domain/` не зависит от `infra/` и transport-слоев.
- `app/` не должен напрямую знать детали конкретных провайдеров, только интерфейсы.
- Инверсии зависимостей оформляются через явные контракты / порты.

## Точки расширения (providers / adapters)

- Адаптеры внешних систем (DB, queue, payment, email, auth provider)
- Транспортные адаптеры (HTTP, background jobs, CLI)
- Feature flags / configuration providers

Каждая точка расширения должна иметь:

- интерфейс (контракт),
- реализацию(и),
- тестовую/фейковую реализацию при необходимости.

## Кросс-сечения (cross-cutting concerns)

Следующие аспекты внедряются через единые интерфейсы и обвязку, а не ad-hoc по коду:

- `auth` (authn/authz)
- `telemetry` (logging/metrics/tracing)
- `config`
- `feature flags`
- `error handling`

## Проверяемость

- Правила слоев и границ дополнительно фиксируются в `docs/02_architecture/boundaries.md`.
- CI запускает `scripts/architecture_lint.py` (пока базовая проверка структуры, далее — импортные/зависимостные проверки по стеку).
